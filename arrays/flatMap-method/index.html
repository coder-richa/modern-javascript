<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <script src="script.js"></script>
    <title>Flat array method</title>
  </head>
  <body>
    <h1>Flat array method</h1>
    <h2>Code</h2>
    <pre>
        "use strict;";
        // FlatMap function accepts a callback function as an argument and returns array of nested array elements
        // It extracts array to one level down only.
        // The flatMap() method returns a new array formed by applying a given callback function to each element of the array,
        //  and then flattening the result by one level. It is identical to a map() followed by a flat() of depth 1,
        //  but slightly more efficient than calling those two methods separately.

        const arr = [[1, 2], 3, [4, 5], 6, [7, 8], 9, 10];

        const result = arr.flatMap((elem) => elem);
        console.log(result);
        const arr2 = [[1, 2], 3, [[4, 5], 6], [[7, 8], 9, 10]];
        const result2 = arr2.flatMap((elem) => elem);
        console.log(result2);

        const arr3 = [[1, 2], 3, [[4, 5], 6], [[7, 8], 9, 10]];
        const result3 = arr3.flatMap((elem) => elem).flatMap((elem) => elem); // bring 2 level down
        console.log(result3);
        const currency = "EUR";
        let users = [
        {
            name: "john smith",
            pin: 1234,
            account_number: "ABC1234",
            transactions: [
            {
                date: "01/01/2021",
                amount: 1000,
                comment: "Some random amount transfer.",
            },
            {
                date: "02/01/2021",
                amount: -500,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/02/2021",
                amount: 800,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/03/2021",
                amount: -50,
                comment: "Some random amount transfer.",
            },
            ],
        },
        {
            name: "Peter Parker",
            pin: 1234,
            account_number: "ABC1235",
            transactions: [
            {
                date: "01/01/2021",
                amount: 2000,
                comment: "Some random amount transfer.",
            },
            {
                date: "02/01/2021",
                amount: -1500,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/02/2021",
                amount: 800,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/03/2021",
                amount: -150,
                comment: "Some random amount transfer.",
            },
            ],
        },
        {
            name: "merry JANE",
            pin: 1234,
            account_number: "ABC1236",
            transactions: [
            {
                date: "01/01/2021",
                amount: 1000,
                comment: "Some random amount transfer.",
            },
            {
                date: "02/01/2021",
                amount: -250,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/02/2021",
                amount: 900,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/03/2021",
                amount: 350,
                comment: "Some random amount transfer.",
            },
            ],
        },
        {
            name: "john cena",
            pin: 1234,
            account_number: "ABC1237",
            transactions: [
            {
                date: "01/01/2021",
                amount: 1000,
                comment: "Some random amount transfer.",
            },
            {
                date: "02/01/2021",
                amount: -500,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/02/2021",
                amount: 800,
                comment: "Some random amount transfer.",
            },
            {
                date: "01/03/2021",
                amount: -50,
                comment: "Some random amount transfer.",
            },
            ],
        },
        ];

        const createUsername = (user) => {
        let words = user.name.toLowerCase().split(" ");
        // Map creates a new array with the initials which can be used further to create username
        let initials = words
            .map(function (word) {
            return word[0];
            })
            .join("");
        user.username = initials;
        };

        const formatAmount = (amount) => `${currency} ${amount}`;

        const formatUser = (user) => {
        user.name = user.name.toUpperCase();
        createUsername(user);
        user.transactions.forEach((transaction) => {
            transaction.desctiption = `${user.name} has ${
            transaction.amount > 0 ? "deposited" : "withdrew"
            } ${formatAmount(Math.abs(transaction.amount))} on ${transaction.date}`;
        });
        };
        // Use forEach where no new array is required
        users.forEach(formatUser);

        let allUserTransactionAmount = users.flatMap((user) =>
        user.transactions.map((transaction) => transaction.amount)
        );
        // get transactions of all users
        console.log(allUserTransactionAmount);

        
    </pre>
    <h2>Output</h2>
    <pre>
        Array(10) [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]
        Array(8) [ 1, 2, 3, [4,5], 6, [7,8], 9, 10 ]
        Array(10) [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]
        Array(16)[1000,  -500,  800,  -50,  2000,  -1500,  800,  -150,  1000,  -250,  900,  350,  1000,  -500,  800,  -50]
  
    </pre>
  </body>
</html>
